<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Beef Box ‚Äî Join Invite</title>
  <meta name="description" content="Join this Beef Box case." />
  <style>
    :root {
      color-scheme: dark;
    }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      background: #0b0b0b;
      color: #fff;
      display: grid;
      min-height: 100svh;
      place-items: center;
    }
    .card {
      width: min(640px, 92vw);
      background: #131313;
      border: 1px solid #242424;
      border-radius: 16px;
      padding: 24px;
      box-shadow: 0 10px 30px rgba(0,0,0,.35);
    }
    h1 { margin: 0 0 8px; font-size: 22px; }
    p { margin: 10px 0; color: #cfcfcf; }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; }
    .row { display: flex; gap: 12px; flex-wrap: wrap; margin-top: 16px; }
    button, a.btn {
      appearance: none;
      border: 0;
      border-radius: 12px;
      padding: 14px 16px;
      font-weight: 700;
      cursor: pointer;
      text-decoration: none;
      transition: transform .04s ease;
    }
    .primary { background: #00cfff; color: #000; }
    .secondary { background: #262626; color: #fff; }
    button:active, a.btn:active { transform: translateY(1px); }
    .dim { color: #9aa0a6; font-size: 13px; margin-top: 14px; }
    .idpill {
      display:inline-block; padding:6px 10px; border-radius: 999px;
      background:#1e1e1e; border:1px solid #2a2a2a; color:#9bdcff;
    }
  </style>
</head>
<body>
  <main class="card">
    <h1>You've been summoned üçñ</h1>
    <p>Someone wants you to join a Beef Box case.</p>
    <p id="beefIdWrap" style="display:none">Beef ID: <span id="beefId" class="idpill"></span></p>

    <div class="row">
      <button id="openAppBtn" class="primary">Open in Beef Box</button>
      <a id="downloadBtn" class="btn secondary" href="#" rel="noopener">Download the App</a>
    </div>

    <p class="dim">If you already have the app, tap <b>Open in Beef Box</b>. If nothing happens, install the app and try again.</p>
  </main>

  <script>
    // --- Parse /invite/:beefId from the URL ---
    const path = window.location.pathname; // e.g. "/invite/pgs43bcc"
    const match = path.match(/^\/invite\/([^\/?#]+)/i);
    const beefId = match ? decodeURIComponent(match[1]) : null;

    // Temporary store links ‚Äî replace with real App Store/Play links when ready
    const IOS_STORE = "https://apps.apple.com/";    // TODO: put your real iOS App Store URL
    const ANDROID_STORE = "https://play.google.com/"; // TODO: put your real Play Store URL

    // Your custom scheme
    const SCHEME = "beefbox://invite/";

    // Update UI
    if (beefId) {
      document.getElementById('beefId').textContent = beefId;
      document.getElementById('beefIdWrap').style.display = 'block';
    }

    // Basic platform sniff (good enough for this landing)
    const ua = navigator.userAgent || "";
    const isAndroid = /Android/i.test(ua);
    const isIOS = /iPhone|iPad|iPod/i.test(ua);

    const downloadBtn = document.getElementById('downloadBtn');
    downloadBtn.href = isAndroid ? ANDROID_STORE : IOS_STORE;

    // Deep link open + fallback on click
    document.getElementById('openAppBtn').addEventListener('click', () => {
      const deepLink = SCHEME + (beefId || "");

      // Try to open the app
      window.location.href = deepLink;

      // Fallback to the correct store after ~1.2s
      setTimeout(() => {
        window.location.href = isAndroid ? ANDROID_STORE : IOS_STORE;
      }, 1200);
    });
  </script>
</body>
</html>
